<div class="dashboard">

  <!-- Statistiques des échanges -->
  <div class="stats">
    <div class="stat-card accepted">
      <i class="material-icons">check_circle</i>
      <div class="stat-content">
        <h2>Échanges Acceptés</h2>
        <p class="stat-number">{{ countEchangesAcceptes }}</p>
      </div>
    </div>
    <div class="stat-card refused">
      <i class="material-icons">cancel</i>
      <div class="stat-content">
        <h2>Échanges Refusés</h2>
        <p class="stat-number">{{ countEchangesRefuses }}</p>
      </div>
    </div>
    <div class="stat-card waiting">
      <i class="material-icons">hourglass_empty</i>
      <div class="stat-content">
        <h2>Échanges En Attente</h2>
        <p class="stat-number">{{ countEchangesEnAttente }}</p>
      </div>
    </div>
    <div class="stat-card ongoing">
      <i class="material-icons">autorenew</i>
      <div class="stat-content">
        <h2>Échanges En Cours</h2>
        <p class="stat-number">{{ countEchangesEnCours }}</p>
      </div>
    </div>
    <div class="stat-card users">
      <i class="material-icons">group</i>
      <div class="stat-content">
        <h2>Utilisateurs</h2>
        <p class="stat-number">{{ utilisateurCount }}</p>
      </div>
    </div>
  </div>

  <div class="tables-container">
    <!-- Liste des utilisateurs -->
    <div class="table-container">
      <h1>Liste des comptes des utilisateurs</h1>
      <table mat-table [dataSource]="utilisateurs" class="mat-elevation-z8">
        <!-- Nom Column -->
        <ng-container matColumnDef="nom">
          <th mat-header-cell *matHeaderCellDef> Nom </th>
          <td mat-cell *matCellDef="let utilisateur"> {{ utilisateur.nom }} </td>
        </ng-container>

        <!-- Prénom Column -->
        <ng-container matColumnDef="prenom">
          <th mat-header-cell *matHeaderCellDef> Prénom </th>
          <td mat-cell *matCellDef="let utilisateur"> {{ utilisateur.prenom }} </td>
        </ng-container>

        <!-- Email Column -->
        <ng-container matColumnDef="email">
          <th mat-header-cell *matHeaderCellDef> Email </th>
          <td mat-cell *matCellDef="let utilisateur"> {{ utilisateur.email }} </td>
        </ng-container>

        <ng-container matColumnDef="actions">
          <th mat-header-cell *matHeaderCellDef> Actions </th>
          <td mat-cell *matCellDef="let utilisateur">
            <button mat-button class="delete-button" (click)="onDelete(utilisateur)">Supprimer</button>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumnsUtilisateurs"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumnsUtilisateurs;"></tr>
      </table>
    </div>

    <div class="table-container">
      <h1>Liste des échanges</h1>
      <table mat-table [dataSource]="echanges" class="mat-elevation-z8 styled-table">



        <ng-container matColumnDef="type">
          <th mat-header-cell *matHeaderCellDef> Type </th>
          <td mat-cell *matCellDef="let echange">
            <div class="image-card">
              <img [src]="echange.objet_proposant?.image_url" alt="Image de l'objet proposable" class="object-image">
              <span>vs</span>

              <img [src]="echange.objet_acceptant?.image_url" alt="Image de l'objet acceptant" class="object-image">
            </div>
          </td>
        </ng-container>
        <ng-container matColumnDef="utilisateurs">
          <th mat-header-cell *matHeaderCellDef> proposant / acceptant </th>
          <td mat-cell *matCellDef="let echange">
            <span *ngIf="echange.utilisateur_proposant_id && echange.utilisateur_proposant_id.prenom">
              {{ echange.utilisateur_proposant_id.prenom }}
            </span>
              vs
            <span *ngIf="echange.utilisateur_acceptant_id && echange.utilisateur_acceptant_id.prenom">
              {{ echange.utilisateur_acceptant_id.prenom }}
            </span>
          </td>
        </ng-container>

        <!-- Image Acceptant Column -->
        <ng-container matColumnDef="imageAcceptant">
          <th mat-header-cell *matHeaderCellDef> Image Acceptant </th>
          <td mat-cell *matCellDef="let echange">
            <div class="image-card">
              <img [src]="echange.objet_acceptant.image_url" alt="Image Acceptant" class="object-image">
            </div>
          </td>
        </ng-container>

        <!-- Date Column -->
        <ng-container matColumnDef="date">
          <th mat-header-cell *matHeaderCellDef> Date </th>
          <td mat-cell *matCellDef="let echange">
            {{ echange.date_proposition | date:'dd/MM/yyyy' }}
          </td>
        </ng-container>

        <!-- Statut Column -->
        <ng-container matColumnDef="statut">
          <th mat-header-cell *matHeaderCellDef> Statut </th>
          <td mat-cell *matCellDef="let echange">
            <div class="status-card" [ngClass]="getStatusClass(echange.statut)">
              {{ echange.statut }}
            </div>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumnsEchanges"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumnsEchanges;"></tr>
      </table>
    </div>
  </div>





